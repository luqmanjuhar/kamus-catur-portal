<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KAMUS CATUR CHESS EVENT â€” Semak & Muat Turun</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Soft Orange-White Theme */
    .soft-card { backdrop-filter: saturate(180%) blur(6px); }
    .ring-focus:focus { outline: none; box-shadow: 0 0 0 4px rgba(251, 146, 60, .25); }
    .bg-page {
      background:
        radial-gradient(1000px 600px at 0% 0%, rgba(253,186,116,.25) 0%, transparent 50%),
        radial-gradient(900px 600px at 100% 10%, rgba(251,146,60,.18) 0%, transparent 55%),
        #ffffff;
    }
    .btn { transition: transform .06s ease, filter .2s ease; }
    .btn:active { transform: translateY(1px); filter: brightness(.97); }
    .shadow-soft { box-shadow: 0 8px 24px rgba(15,23,42,.06); }
  </style>
</head>
<body class="min-h-screen bg-page text-slate-800 font-sans antialiased">
  <div class="max-w-3xl mx-auto px-4 py-10 sm:py-14">
    
    <!-- Header -->
    <header class="mb-8 sm:mb-10">
      <div class="flex items-center gap-4">
        <!-- LOGO RASMI -->
        <div class="w-16 h-16 sm:w-20 sm:h-20 shrink-0 rounded-xl overflow-hidden shadow-soft bg-white p-1">
          <img 
            src="https://raw.githubusercontent.com/luqmanjuhar/kamus-catur-portal/92e079ea8c12e787a70a2a5ceb2ecf6950b6adcf/LOGO%20PLANNER_TOURNAMENT%20(1).png" 
            alt="Logo Rasmi Kamus Catur Enterprise" 
            class="w-full h-full object-contain"
          />
        </div>
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-900">KAMUS CATUR CHESS EVENT</h1>
          <p class="text-slate-500 text-sm mt-1">Pusat untuk download sijil, download foto kejohanan dan chess result</p>
        </div>
      </div>
    </header>

    <!-- Event Selection Only -->
    <section class="mb-6 rounded-2xl soft-card bg-white/80 border border-orange-100 p-5 sm:p-6 shadow-soft">
      <h2 class="text-lg font-semibold mb-4 text-slate-900">Pilih Kejohanan</h2>
      <div class="space-y-4">
        <div>
          <label for="mainEventSelect" class="block text-sm mb-2 text-slate-600">Sila Pilih Kejohanan</label>
          <select id="mainEventSelect" class="w-full ring-focus bg-white border border-slate-200 rounded-xl px-4 py-3 text-slate-800">
            <option value="">-- Pilih Kejohanan --</option>
          </select>
        </div>
        <!-- Category selection removed -->
      </div>
    </section>

    <!-- Navigation Buttons -->
    <div id="navigationButtons" class="mb-6 flex flex-wrap gap-2 justify-center opacity-50 pointer-events-none">
      <button id="btnEcert" class="btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 font-medium cursor-not-allowed">
        eCert
      </button>
      <button id="btnFoto" class="btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 cursor-not-allowed">
        Foto
      </button>
      <button id="btnChess" class="btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 cursor-not-allowed">
        Chess Result
      </button>
    </div>

    <!-- eCert Section -->
    <section id="sectionEcert" class="rounded-2xl soft-card bg-white/80 border border-orange-100 p-5 sm:p-6 shadow-soft hidden">
      <h2 class="text-lg font-semibold mb-4 text-slate-900">Semak & Muat Turun</h2>
      <form id="checkForm" class="space-y-4">
        <!-- Kod Sijil -->
        <div>
          <label for="codeInput" class="block text-sm mb-1 text-slate-600">Kod Sijil</label>
          <input id="codeInput" type="text" inputmode="latin" autocomplete="off" placeholder="Contoh: 0000"
                 class="w-full ring-focus bg-white border border-slate-200 rounded-xl px-4 py-3 text-slate-800 placeholder-slate-400">
          <p class="text-xs text-slate-500 mt-2">Masukkan Kod Sijil unik (contoh: 0000). Masukkan 4 digit akhir no kad pengenalan pemain.</p>
        </div>

        <!-- Tindakan -->
        <div class="flex items-center gap-3">
          <button type="submit" class="btn rounded-xl bg-orange-500 hover:bg-orange-600 text-white px-5 py-3 font-medium shadow-soft">
            Semak & Muat Turun
          </button>
          <button type="button" id="clearBtn" class="btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-3">
            Kosongkan
          </button>
        </div>
      </form>

      <!-- Keputusan -->
      <div id="resultBox" class="mt-6 hidden">
        <div class="rounded-xl bg-white border border-orange-100 p-4 shadow-soft">
          <div class="flex flex-col gap-3">
            <div>
              <p class="text-orange-600 text-sm font-medium mb-1">Padanan ditemui</p>
              <h3 id="resName" class="text-lg font-semibold text-slate-900"></h3>
              <p id="resEvent" class="text-slate-700 text-sm mt-1"></p>
              <p id="resDate" class="text-slate-500 text-xs mt-1"></p>
            </div>
            <!-- Grid layout for multiple certs -->
            <div id="certList" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></div>
          </div>
        </div>
      </div>

      <!-- Makluman -->
      <div id="alertBox" class="mt-6 hidden">
        <div id="alertCard" class="rounded-xl bg-orange-50 border border-orange-200 p-4">
          <p id="alertText" class="text-orange-700 text-sm"></p>
        </div>
      </div>
    </section>

    <!-- Foto Section -->
    <section id="sectionFoto" class="mt-8 rounded-2xl soft-card bg-white/80 border border-orange-100 p-5 sm:p-6 shadow-soft hidden">
      <h2 class="text-lg font-semibold mb-4 text-slate-900">Galeri Foto</h2>
      <div id="photoEvents" class="space-y-4">
        <!-- Photo events will be loaded here -->
      </div>
    </section>

    <!-- Chess Result Section -->
    <section id="sectionChess" class="mt-8 rounded-2xl soft-card bg-white/80 border border-orange-100 p-5 sm:p-6 shadow-soft hidden">
      <h2 class="text-lg font-semibold mb-4 text-slate-900">Kejohanan Catur</h2>
      <div id="chessEvents" class="space-y-4">
        <!-- Chess events will be loaded here -->
      </div>
    </section>

    <!-- Senarai event ringkas -->
    <div class="mt-6">
      <h3 class="text-sm font-semibold text-slate-700 mb-2">Event dimuatkan</h3>
      <div id="eventChips" class="flex flex-wrap gap-2"></div>
    </div>

    <!-- Footer -->
    <footer class="mt-10 text-center text-slate-500 text-xs">
      Hak Cipta &copy; Kamus Catur Enterprise
    </footer>
  </div>

  <script>
    // --- CONFIGURATION AREA ---
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT2iJ2osj2c3BF7VsfswyfHjU0Tb8c-KkYUNRUDqorvj_xXPhIcQZ3QU7ZnSvJlDNkqgFl7LqJ-9yHq/pub?gid=1625987910&single=true&output=csv';
    const CHESS_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT2iJ2osj2c3BF7VsfswyfHjU0Tb8c-KkYUNRUDqorvj_xXPhIcQZ3QU7ZnSvJlDNkqgFl7LqJ-9yHq/pub?gid=1676401999&single=true&output=csv';

    // Data storan dalam memori
    let records = []; // {event, date, name, ic, achievement, type, category, code, url}
    let chessEvents = []; // {event, date, resultLink, photoLink}

    const dom = {
      mainEventSelect: document.getElementById('mainEventSelect'),
      navigationButtons: document.getElementById('navigationButtons'),
      codeInput: document.getElementById('codeInput'),
      checkForm: document.getElementById('checkForm'),
      clearBtn: document.getElementById('clearBtn'),
      resultBox: document.getElementById('resultBox'),
      resName: document.getElementById('resName'),
      resEvent: document.getElementById('resEvent'),
      resDate: document.getElementById('resDate'),
      alertBox: document.getElementById('alertBox'),
      alertText: document.getElementById('alertText'),
      certList: document.getElementById('certList'),
      eventChips: document.getElementById('eventChips'),
      chessEvents: document.getElementById('chessEvents'),
      photoEvents: document.getElementById('photoEvents'),
      btnEcert: document.getElementById('btnEcert'),
      btnFoto: document.getElementById('btnFoto'),
      btnChess: document.getElementById('btnChess'),
      sectionEcert: document.getElementById('sectionEcert'),
      sectionFoto: document.getElementById('sectionFoto'),
      sectionChess: document.getElementById('sectionChess'),
    };

    function setAlert(msg) {
      dom.alertText.textContent = msg;
      dom.alertBox.classList.remove('hidden');
      setTimeout(() => dom.alertBox.classList.add('hidden'), 5000);
    }

    function setResultList(recs) {
      if (!recs || !recs.length) {
        dom.resultBox.classList.add('hidden');
        return;
      }
      const first = recs[0];
      dom.resName.textContent = first.name;
      dom.resEvent.textContent = first.event;
      dom.resDate.textContent = first.date ? `Tarikh: ${first.date}` : '';

      dom.certList.innerHTML = '';
      recs.forEach(r => {
        const card = document.createElement('a');
        card.target = '_blank';
        card.rel = 'noopener noreferrer';
        card.href = r.url || '#';
        
        // Determine style based on Certificate Type (Participation vs Achievement)
        const typeLower = (r.type || '').toLowerCase();
        const isAchievement = typeLower.includes('pencapaian') || typeLower.includes('johan') || typeLower.includes('tempat') || typeLower.includes('achievement');
        
        // Styling classes: Two visually distinct styles
        const baseClasses = 'group block rounded-xl border p-4 transition shadow-soft flex items-center justify-between gap-3 relative overflow-hidden';
        const colorClasses = isAchievement 
          ? 'bg-amber-50 border-amber-200 hover:bg-amber-100' // Gold/Amber for Achievement
          : 'bg-white border-slate-200 hover:bg-orange-50';  // Standard for Participation

        card.className = `${baseClasses} ${colorClasses}`;
        
        const title = r.category || 'Sijil';
        const typeLabel = r.type ? r.type : (isAchievement ? 'Sijil Pencapaian' : 'Sijil Penyertaan');
        const achievementText = r.achievement ? `<span class="text-xs font-bold uppercase tracking-wider opacity-80 block mt-1">${r.achievement}</span>` : '';

        card.innerHTML = `
          <div>
            <span class="inline-block px-2 py-0.5 rounded text-[10px] font-bold uppercase mb-1 ${isAchievement ? 'bg-amber-200 text-amber-800' : 'bg-slate-100 text-slate-600'}">
              ${typeLabel}
            </span>
            <p class="font-medium text-slate-900 leading-tight">${title}</p>
            ${achievementText}
            <p class="text-xs text-slate-500 mt-1.5 flex items-center gap-1">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
              Klik untuk muat turun PDF
            </p>
          </div>
          <div class="shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${isAchievement ? 'bg-amber-200 text-amber-700' : 'bg-orange-100 text-orange-600'}">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
          </div>
        `;
        dom.certList.appendChild(card);
      });

      dom.resultBox.classList.remove('hidden');
    }

    function updateMainEventSelect() {
      const allEvents = [...new Set([...records.map(r => r.event), ...chessEvents.map(c => c.event)])].sort((a, b) => a.localeCompare(b));
      const current = dom.mainEventSelect.value;
      dom.mainEventSelect.innerHTML = '<option value="">-- Pilih Kejohanan --</option>';
      allEvents.forEach(e => {
        const opt = document.createElement('option');
        opt.value = e;
        opt.textContent = e;
        dom.mainEventSelect.appendChild(opt);
      });
      if (allEvents.includes(current)) dom.mainEventSelect.value = current;
    }

    function enableNavigation() {
      dom.navigationButtons.classList.remove('opacity-50', 'pointer-events-none');
      dom.btnEcert.className = 'btn rounded-xl bg-orange-500 text-white px-4 py-2 font-medium shadow-soft';
      dom.btnFoto.className = 'btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-2';
      dom.btnChess.className = 'btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-2';
      switchSection('ecert');
    }

    function disableNavigation() {
      dom.navigationButtons.classList.add('opacity-50', 'pointer-events-none');
      dom.btnEcert.className = 'btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 font-medium cursor-not-allowed';
      dom.btnFoto.className = 'btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 cursor-not-allowed';
      dom.btnChess.className = 'btn rounded-xl bg-gray-300 text-gray-500 px-4 py-2 cursor-not-allowed';
      dom.sectionEcert.classList.add('hidden');
      dom.sectionFoto.classList.add('hidden');
      dom.sectionChess.classList.add('hidden');
    }

    function updateEvents() {
      const selectedMainEvent = dom.mainEventSelect.value;
      dom.eventChips.innerHTML = '';
      if (!selectedMainEvent) {
        return;
      }
      const chip = document.createElement('button');
      chip.type = 'button';
      chip.textContent = `${selectedMainEvent}`;
      chip.className = 'text-[11px] md:text-xs rounded-full bg-white border border-slate-200 hover:bg-orange-50 text-slate-700 px-3 py-1.5';
      dom.eventChips.appendChild(chip);
    }

    function updateChessEvents() {
      const selectedMainEvent = dom.mainEventSelect.value;
      dom.chessEvents.innerHTML = '';
      if (!selectedMainEvent) {
        dom.chessEvents.innerHTML = '<p class="text-slate-500 text-sm">Pilih kejohanan utama dahulu.</p>';
        return;
      }
      const filteredChess = chessEvents.filter(chess => chess.event === selectedMainEvent);
      if (!filteredChess.length) {
        dom.chessEvents.innerHTML = '<p class="text-slate-500 text-sm">Tiada keputusan catur untuk kejohanan ini.</p>';
        return;
      }
      filteredChess.forEach(chess => {
        const card = document.createElement('div');
        card.className = 'rounded-xl bg-white border border-orange-200 p-4 shadow-soft';
        card.innerHTML = `
          <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3">
            <div>
              <h3 class="font-semibold text-slate-900">${chess.event}</h3>
              <p class="text-slate-500 text-sm mt-1">${chess.date ? `Tarikh: ${chess.date}` : ''}</p>
            </div>
            <div class="flex gap-2">
              ${chess.resultLink ? `<a href="${chess.resultLink}" target="_blank" rel="noopener noreferrer" class="btn rounded-lg bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 text-sm font-medium">Keputusan</a>` : ''}
            </div>
          </div>`;
        dom.chessEvents.appendChild(card);
      });
    }

    function updatePhotoEvents() {
      const selectedMainEvent = dom.mainEventSelect.value;
      dom.photoEvents.innerHTML = '';
      if (!selectedMainEvent) {
        dom.photoEvents.innerHTML = '<p class="text-slate-500 text-sm">Pilih kejohanan utama dahulu.</p>';
        return;
      }
      const filteredPhotos = chessEvents.filter(chess => chess.event === selectedMainEvent && chess.photoLink);
      if (!filteredPhotos.length) {
        dom.photoEvents.innerHTML = '<p class="text-slate-500 text-sm">Tiada foto untuk kejohanan ini.</p>';
        return;
      }
      filteredPhotos.forEach(chess => {
        const card = document.createElement('div');
        card.className = 'rounded-xl bg-white border border-orange-200 p-4 shadow-soft';
        card.innerHTML = `
          <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3">
            <div>
              <h3 class="font-semibold text-slate-900">${chess.event}</h3>
              <p class="text-slate-500 text-sm mt-1">${chess.date ? `Tarikh: ${chess.date}` : ''}</p>
            </div>
            <div class="flex gap-2">
              <a href="${chess.photoLink}" target="_blank" rel="noopener noreferrer" class="btn rounded-lg bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 text-sm font-medium">Lihat Foto</a>
            </div>
          </div>`;
        dom.photoEvents.appendChild(card);
      });
    }

    function switchSection(activeSection) {
      dom.sectionEcert.classList.add('hidden');
      dom.sectionFoto.classList.add('hidden');
      dom.sectionChess.classList.add('hidden');
      dom.btnEcert.className = 'btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-2';
      dom.btnFoto.className = 'btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-2';
      dom.btnChess.className = 'btn rounded-xl bg-white hover:bg-orange-50 text-slate-800 border border-slate-200 px-4 py-2';
      if (activeSection === 'ecert') {
        dom.sectionEcert.classList.remove('hidden');
        dom.btnEcert.className = 'btn rounded-xl bg-orange-500 text-white px-4 py-2 font-medium shadow-soft';
      } else if (activeSection === 'foto') {
        dom.sectionFoto.classList.remove('hidden');
        dom.btnFoto.className = 'btn rounded-xl bg-orange-500 text-white px-4 py-2 font-medium shadow-soft';
      } else if (activeSection === 'chess') {
        dom.sectionChess.classList.remove('hidden');
        dom.btnChess.className = 'btn rounded-xl bg-orange-500 text-white px-4 py-2 font-medium shadow-soft';
      }
    }

    function normalize(h) { return (h || '').toString().trim().toLowerCase(); }

    function mapHeaders(headers) {
      const map = {};
      headers.forEach((h, i) => {
        const n = normalize(h);
        if (n.includes('nama kejohanan')) map.event = i;
        else if (n.includes('tarikh')) map.date = i;
        else if (n.includes('nama peserta')) map.name = i;
        else if (n.includes('no kad') || n.includes('kad pengenalan')) map.ic = i;
        else if (n.includes('pencapaian') || n.includes('penyertaan')) map.achievement = i;
        else if (n.includes('jenis sijil')) map.type = i;
        else if (n.includes('kategori')) map.category = i; // Matches 'Kategori/Anugerah'
        else if (n.includes('kod sijil')) map.code = i;
        else if (n.includes('url') && n.includes('pdf')) map.url = i;
        else if (n.includes('url') && !map.url) map.url = i;
      });
      return map;
    }

    function mapChessHeaders(headers) {
      const map = {};
      headers.forEach((h, i) => {
        const n = normalize(h);
        if (n.includes('nama kejohanan')) map.event = i;
        else if (n.includes('tarikh')) map.date = i;
        else if (n.includes('link chess result')) map.resultLink = i;
        else if (n.includes('link google photo')) map.photoLink = i;
      });
      return map;
    }

    function parseCSV(text) {
      const rows = [];
      let i = 0, field = '', row = [], inQuotes = false;
      const pushField = () => { row.push(field); field = ''; };
      const pushRow = () => { rows.push(row); row = []; };
      while (i < text.length) {
        const c = text[i];
        if (inQuotes) {
          if (c === '"') {
            if (text[i + 1] === '"') { field += '"'; i++; }
            else { inQuotes = false; }
          } else { field += c; }
        } else {
          if (c === '"') inQuotes = true;
          else if (c === ',') pushField();
          else if (c === '\n') { pushField(); pushRow(); }
          else if (c === '\r') { /* ignore */ }
          else field += c;
        }
        i++;
      }
      pushField();
      if (row.length) pushRow();
      while (rows.length && rows[rows.length - 1].every(v => v.trim() === '')) rows.pop();
      return rows;
    }

    function toRecords(rows) {
      if (!rows.length) return [];
      const headers = rows[0];
      const idx = mapHeaders(headers);
      const out = [];
      for (let r = 1; r < rows.length; r++) {
        const row = rows[r];
        const rec = {
          event: (row[idx.event] || '').trim(),
          date: (row[idx.date] || '').trim(),
          name: (row[idx.name] || '').trim(),
          ic: (row[idx.ic] || '').replace(/[^0-9]/g, '').trim(),
          achievement: (row[idx.achievement] || '').trim(),
          type: (row[idx.type] || '').trim(),
          category: (row[idx.category] || '').trim(),
          code: (row[idx.code] || '').trim(),
          url: (row[idx.url] || '').trim(),
        };
        if (rec.event && rec.name && rec.code) out.push(rec);
      }
      return out;
    }

    function toChessRecords(rows) {
      if (!rows.length) return [];
      const headers = rows[0];
      const idx = mapChessHeaders(headers);
      const out = [];
      for (let r = 1; r < rows.length; r++) {
        const row = rows[r];
        const rec = {
          event: (row[idx.event] || '').trim(),
          date: (row[idx.date] || '').trim(),
          resultLink: (row[idx.resultLink] || '').trim(),
          photoLink: (row[idx.photoLink] || '').trim(),
        };
        if (rec.event) out.push(rec);
      }
      return out;
    }

    async function loadCSV(url) {
      try {
        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) throw new Error('Gagal memuatkan CSV');
        const text = await res.text();
        const rows = parseCSV(text.replace(/^\uFEFF/, ''));
        const parsed = toRecords(rows);
        if (!parsed.length) throw new Error('Tiada rekod sah ditemui. Semak tajuk lajur anda.');
        records = parsed;
        updateMainEventSelect();
        updateEvents();
        setAlert('Data Google Sheet dimuatkan.');
      } catch (e) {
        setAlert(e.message || 'Ralat memuatkan CSV.');
      }
    }

    async function loadChessCSV(url) {
      try {
        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) throw new Error('Gagal memuatkan CSV catur');
        const text = await res.text();
        const rows = parseCSV(text.replace(/^\uFEFF/, ''));
        const parsed = toChessRecords(rows);
        chessEvents = parsed;
        updateMainEventSelect();
        updateChessEvents();
        updatePhotoEvents();
      } catch (e) {
        console.error('Ralat memuatkan data catur:', e);
      }
    }

    function resetForm() {
      dom.codeInput.value = '';
      dom.resultBox.classList.add('hidden');
      dom.alertBox.classList.add('hidden');
      dom.codeInput.focus();
    }

    // Semak
    dom.checkForm.addEventListener('submit', (e) => {
      e.preventDefault();
      dom.resultBox.classList.add('hidden');

      const selectedEvent = dom.mainEventSelect.value;
      const code = dom.codeInput.value.trim();

      if (!records.length) {
        setAlert('Tiada data dimuatkan.');
        return;
      }
      if (!selectedEvent) {
        setAlert('Sila pilih kejohanan terlebih dahulu.');
        return;
      }
      if (!code) {
        setAlert('Sila masukkan Kod Sijil.');
        return;
      }

      // FILTER LOGIC: Finds ALL records matching Event and Code (Category filter removed)
      const recs = records.filter(r =>
        r.event === selectedEvent &&
        r.code.toUpperCase() === code.toUpperCase()
      );

      if (!recs.length) {
        setAlert('Maaf, padanan tidak ditemui. Semak kejohanan dan Kod Sijil anda.');
        return;
      }
      setResultList(recs);
    });

    dom.clearBtn.addEventListener('click', resetForm);

    // Main event selection listener
    dom.mainEventSelect.addEventListener('change', (e) => {
      // Check value directly
      if (e.target.value) {
        enableNavigation();
        updateEvents();
        updateChessEvents();
        updatePhotoEvents();
      } else {
        disableNavigation();
      }
    });

    dom.btnEcert.addEventListener('click', () => switchSection('ecert'));
    dom.btnFoto.addEventListener('click', () => switchSection('foto'));
    dom.btnChess.addEventListener('click', () => switchSection('chess'));

    updateMainEventSelect();
    updateEvents();
    updateChessEvents();
    updatePhotoEvents();
    loadCSV(CSV_URL);
    loadChessCSV(CHESS_CSV_URL);
  </script>
</body>
</html>
